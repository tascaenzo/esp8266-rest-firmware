<section class="doc" id="gpio-view">
  <header class="doc-header">
    <div>
      <h2>GPIO API</h2>
      <p class="lead">
        Inspect and adjust pin configuration. Writes use <code>/api/pin/set</code>
        and respect firmware safety classifications.
      </p>
    </div>
    <div class="doc-actions">
      <button id="gpio-refresh" class="btn-secondary">Reload pins</button>
    </div>
  </header>

  <section class="card">
    <header>
      <h3>Pin map</h3>
      <small>Live snapshot from RuntimeState.deviceState</small>
    </header>

    <div class="table-wrapper">
      <table class="data-table" id="gpio-table">
        <thead>
          <tr>
            <th>Pin</th>
            <th>Mode</th>
            <th>State</th>
            <th>Safety</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </section>

  <section class="card surface">
    <header>
      <div>
        <div class="eyebrow">Backend call</div>
        <h3>GET /api/state</h3>
        <small>Used to render the table above</small>
      </div>
      <div class="pill">Read-only</div>
    </header>
    <div class="api-grid">
      <div>
        <p class="muted">Curl example with auth headers if enabled.</p>
        <pre class="code"><code id="gpio-curl-read"></code></pre>
      </div>
      <div>
        <p class="muted">Raw firmware JSON snapshot.</p>
        <div class="json-launcher">
          <button id="gpio-read-open" class="btn-tertiary">Apri risposta</button>
          <small id="gpio-read-hint" class="muted">Nessuna risposta ancora</small>
        </div>
      </div>
    </div>
  </section>

  <section class="card">
    <header>
      <h3>Manual write</h3>
      <small>Use this to set a pin deterministically.</small>
    </header>
    <div class="form-grid">
      <label>
        Pin ID
        <input class="gpio-input" type="text" id="gpio-id" placeholder="GPIO4" />
      </label>
      <label>
        Mode
        <input class="gpio-input" type="text" id="gpio-mode" placeholder="Output" />
      </label>
      <label>
        Value
        <input class="gpio-input" type="number" id="gpio-value" placeholder="1" />
      </label>
    </div>
    <div class="form-actions">
      <button id="gpio-apply" class="btn-primary">Apply</button>
      <span id="gpio-status" class="muted"></span>
    </div>
  </section>

  <section class="card surface">
    <header>
      <div>
        <div class="eyebrow">Backend call</div>
        <h3>PATCH /api/pin/set</h3>
        <small>Uses payload below</small>
      </div>
      <div class="pill">Mutable</div>
    </header>
    <div class="api-grid">
      <div>
        <p class="muted">Payload reflects the manual form.</p>
        <div class="json-launcher">
          <button id="gpio-payload-open" class="btn-tertiary">Apri payload</button>
          <small class="muted">Aggiorna la form per rigenerare</small>
        </div>
      </div>
      <div>
        <p class="muted">Copy/paste cURL matching current settings.</p>
        <pre class="code"><code id="gpio-curl-write"></code></pre>
      </div>
      <div>
        <p class="muted">Firmware JSON reply.</p>
        <div class="json-launcher">
          <button id="gpio-write-open" class="btn-tertiary">Apri risposta</button>
          <small id="gpio-write-hint" class="muted">Nessuna scrittura ancora</small>
        </div>
      </div>
    </div>
  </section>
</section>
